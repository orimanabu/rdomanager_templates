parameter_defaults:
  UpgradeLevelNovaCompute: kilo
  UpgradeInitCommand: |
    set -e
    if subscription-manager status >/dev/null 2<&1; then
      subscription-manager repos --disable=rhel-7-server-openstack-7.0-rpms --disable=rhel-7-server-openstack-7.0-director-rpms
      subscription-manager repos --enable=rhel-7-server-openstack-8.0-rpms --enable=rhel-7-server-openstack-8.0-director-rpms
    elif rhn-channel -l >/dev/null 2>&1; then
      rhn-channel --remove --channel=rhel-x86_64-server-7-ost-7 --channel=rhel-x86_64-server-7-ost-7-director
      rhn-channel --add --channel=rhel-x86_64-server-7-ost-8 --channel=rhel-x86_64-server-7-ost-8-director
    fi

resource_registry:
  OS::TripleO::Tasks::UpdateWorkflow: ../extraconfig/tasks/major_upgrade_pacemaker_init.yaml
  OS::TripleO::Tasks::PackageUpdate:  ../extraconfig/tasks/yum_update_noop.yaml
  OS::TripleO::ControllerPostDeployment: OS::Heat::None
  OS::TripleO::ComputePostDeployment: OS::Heat::None
  OS::TripleO::ObjectStoragePostDeployment: OS::Heat::None
  OS::TripleO::BlockStoragePostDeployment: OS::Heat::None
  OS::TripleO::CephStoragePostDeployment: OS::Heat::None
